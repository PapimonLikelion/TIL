### 2023-12-04

## CORS
- **개요**
  - 교차 출처 리소스 공유(CORS)는 **추가 HTTP 헤더**를 사용하여
  - 한 출처에서 실행중인 웹 어플리케이션이 다른 출처의 선택한 자원에 접근할 수 있는 권한을 부여하도록 **브라우저**에 알려주는 체제

- **같은 출처란?**
  - Protocol, Host, Port 가 다 같아야함
    - 여기서 host는 string으로 비교해서 localhost와 127.0.0.1 은 다른놈임

- **접근 제어 시나리오 [Preflight]**
  - 개요
    - 사전확인 작업 (Options)
    - Client <-> Server

  - **Preflight Request**
    - Origin: 요청 출처   
    - Access-Control-Request-Method: 실제 요청의 메서드
    - Access-Control-Request-Headers: 실제 요청의 추가 헤더

  - **Preflight Response**
    - Access-Control-Allow-Origin: 서버 측 허가 출처
    - Access-Control-Allow-Methods: 서버 측 허가 메서드
    - Access-Control-Allow-Headers: 서버 측 허가 헤더
    - Access-Control-Max-Age: Preflight 응답 캐시 기간 (브라우저야 캐싱해둬)

  - **특징**
    - 응답 코드는 200대일 것
    - 응답 바디는 비어있을 것

- **접근 제어 시나리오 [Simple Request]**
  - Preflight 요청 없이 바로 요청을 날림
  - 다음 조건을 모두 만족해야 Simple Request로 쓸 수 있음
    - GET/POST/HEAD 메서드일 것
    - Content-type은 하기의 작성된 것 중 하나일 것
      - application/x-www-form-urlencoded
      - multipart/form-data
      - text/plain
    - Header는 하기의 작성된 것 중 하나일 것
      - Accept
      - Accept-Language
      - Content-Language
      - Content-Type

- **접근 제어 시나리오 [Credentialed Request]**
  - 인증 관련 헤더를 포함할 때 사용하는 요청
  - 클라이언트 측
    - `credentials: inclued`
  - 서버 측
    - `Access-Control-Allow-Credentials: true`
